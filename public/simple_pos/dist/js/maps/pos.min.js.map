{"version":3,"sources":["pos.js"],"names":["add_invoice_item","item","count","spositems","item_id","Settings","item_addition","id","row","qty","parseFloat","store","JSON","stringify","loadItems","get","total","an","product_tax","invoice_tax","product_discount","order_discount","total_discount","$","empty","time","Date","getTime","remote_printing","ob_info","pos_customer","text","hr","val","user","username","pos_curr_time","date","dateformat","timeformat","order_data","info","bill_data","o_items","b_items","style","pos_head","site_name","prepend","lang","order","bill","parse","each","this","product_id","item_type","type","item_tax_method","tax_method","combo_items","item_qty","item_aqty","quantity","item_ds","discount","item_code","code","item_name","name","replace","net_price","real_unit_price","item_comment","comment","ds","item_discount","formatDecimal","indexOf","pds","split","isNaN","pr_tax","tax","pr_tax_val","inclusive","exclusive","row_no","newTr","tr_html","formatMoney","html","prependTo","oitb","scrollHeight","slimScroll","scrollTo","addClass","find","removeClass","comments","i","len","length","printLine","bprTr","oprTr","append","ts","order_tax","pts","g_total","grand_total","items","b_totals","rounding","round_total","roundNumber","parseInt","total_payable","total_items","totals","bill_totals","merchant_copy","display_kb","display_keyboards","focus","chr","String","fromCharCode","jQuery","browser","mobile","keyboard","autoAccept","alwaysOpen","openOn","usePreview","layout","display","bksp","accept","default","meta1","meta2","customLayout","shift","restrictInput","preventPaste","b","calTax","nav_pointer","pp","p_page","attr","pro_limit","tcp","Popup","data","createWin","then","w","close","Promise","resolve","d","assets","mywindow","window","open","document","write","setTimeout","posScreen","wh","height","total_dh","buttons_dh","items_dh","list_table_dh","outerHeight","str","size","char_per_line","res","newd","read_card","ready","on","e","preventDefault","stopPropagation","hideseek","nodata","no_match_found","n","modal","closest","item_rid","unit_price","console","log","base_url","label","row_id","backdrop","price","is_valid_discount","bootbox","alert","unexpected_value","localStorage","setItem","is_numeric","new_qty","click","protect_delete","dialog","title","enter_pin_code","closeButton","message","buttons","danger","className","callback","success","delete","md5","pin_code","remove","location","href","wrong_pin","keypress","keyCode","trigger","confirm","r_u_sure","result","please_add_product","show","print_img","element","html2canvas","scrollY","scale","canvas","img","toDataURL","post","spos_token","csrf_hash","form","serialize","printOrder","hide","printBill","apply_to","dval","focusToEnd","tval","ajax","url","dataType","cid","cat_id","category_id","products","per_page","autocomplete","source","minLength","autoFocus","delay","response","event","ui","content","_trigger","select","bind","inputmask","placeholder","no","generateCardNo","parent","children","gccode","gcname","gcvalue","gcprice","gcexpiry","file_required_fields","gc_data","Array","gcdata","hasOwnProperty","ref","type_reference_note","suspend","sid","appendTo","submit","gtotal","change","total_paying","total_paid","p_val","rounded_total","slideDown","slideUp","cn","async","balance","incorrect_gift_card","card_no","value","paying","$quick_cash","amt","contents","filter","nodeType","th","thousands_sep","$pi","join","note_count","spos_note","spos_customer","select2","hover","top","offset","menu","target","hasClass","hold_ref","status","msg","error","customer_request_failed","start","width","extend","keyaction","enter","base","$el","is","insertText","TrackData","p","SwipeParserObj","hasTrack1","CardType","ccn1","account","charAt","account_name","exp_month","exp_year","blur","removeData","clear","reload","focus_add_item","shortcut","add","propagate","add_customer","toggle_category_slider","cancel_sale","suspend_sale","print_order","print_bill","finalize_sale","today_sale","open_hold_bills","close_register","fn","v","ajaxSetup","cache","headers","cache-control"],"mappings":"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","file":"../pos.min.js","sourcesContent":["function add_invoice_item(item) {\n    if (count == 1) {\n        spositems = {};\n    }\n    if (item == null) {\n        return;\n    }\n\n    var item_id = Settings.item_addition == 1 ? item.item_id : item.id;\n    if (spositems[item_id]) {\n        spositems[item_id].row.qty = parseFloat(spositems[item_id].row.qty) + 1;\n    } else {\n        spositems[item_id] = item;\n    }\n\n    store('spositems', JSON.stringify(spositems));\n    loadItems();\n    return true;\n}\n\nfunction loadItems() {\n    if (count == 1) {\n        spositems = {};\n    }\n    if (get('spositems')) {\n        total = 0;\n        count = 1;\n        an = 1;\n        product_tax = 0;\n        invoice_tax = 0;\n        product_discount = 0;\n        order_discount = 0;\n        total_discount = 0;\n\n        $('#posTable tbody').empty();\n        var time = new Date().getTime() / 1000;\n        if (Settings.remote_printing != 1) {\n            var pos_customer = 'C: ' + $('#select2-spos_customer-container').text() + '\\n';\n            var hr = 'R: ' + $('#hold_ref').val() + '\\n';\n            var user = 'U: ' + username + '\\n';\n            var pos_curr_time = 'T: ' + date(Settings.dateformat + ' ' + Settings.timeformat, time) + '\\n';\n            var ob_info = pos_customer + hr + user + pos_curr_time + '\\n';\n            order_data.info = ob_info;\n            bill_data.info = ob_info;\n            var o_items = '';\n            var b_items = '';\n        } else {\n            $('#order_span').empty();\n            $('#bill_span').empty();\n            var style = '<style>.bb td, .bb th { border-bottom: 1px solid #DDD; }</style>';\n            var pos_head = '<span style=\"text-align:center;\"><h3>' + Settings.site_name + '</h3>';\n            // var pos_customer = ''; // remove this line and uncomment below to display customer\n            var pos_customer = '<h5>C: ' + $('#select2-spos_customer-container').text() + '</h5>';\n            var hr = '<h5>R: ' + $('#hold_ref').val() + '</h5>';\n            var user = '<h5>U: ' + username + '</h5>';\n            var pos_curr_time = '<h5>T: ' + date(Settings.dateformat + ' ' + Settings.timeformat, time) + '</h5>';\n            $('#order_span').prepend(style + pos_head + '<h4>' + lang.order + '</h4></span>' + pos_customer + hr + user + pos_curr_time);\n            $('#bill_span').prepend(style + pos_head + '<h4>' + lang.bill + '</h4></span>' + pos_customer + hr + user + pos_curr_time);\n            $('#order-table').empty();\n            $('#bill-table').empty();\n        }\n        spositems = JSON.parse(get('spositems'));\n\n        $.each(spositems, function() {\n            var item = this;\n            var item_id = Settings.item_addition == 1 ? item.item_id : item.id;\n            spositems[item_id] = item;\n\n            var product_id = item.row.id,\n                item_type = item.row.type,\n                item_tax_method = parseFloat(item.row.tax_method),\n                combo_items = item.combo_items,\n                item_qty = item.row.qty,\n                item_aqty = parseFloat(item.row.quantity),\n                item_type = item.row.type,\n                item_ds = item.row.discount,\n                item_code = item.row.code,\n                item_name = item.row.name.replace(/\"/g, '&#034;').replace(/'/g, '&#039;');\n            var unit_price = parseFloat(item.row.real_unit_price);\n            var net_price = unit_price;\n            var item_comment = item.row.comment;\n            // var item_was_ordered = item.row.ordered ? item.row.ordered : 0;\n            var item_was_ordered = 0;\n\n            var ds = item_ds ? item_ds : '0';\n            var item_discount = formatDecimal(ds);\n            if (ds.indexOf('%') !== -1) {\n                var pds = ds.split('%');\n                if (!isNaN(pds[0])) {\n                    item_discount = formatDecimal(parseFloat((net_price * parseFloat(pds[0])) / 100), 4);\n                }\n            }\n            product_discount += formatDecimal(item_discount * item_qty, 4);\n            net_price = formatDecimal(net_price - item_discount, 4);\n\n            var pr_tax = parseFloat(item.row.tax),\n                pr_tax_val = 0;\n            if (pr_tax !== null && pr_tax != 0) {\n                if (item_tax_method == 0) {\n                    pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100 + parseFloat(pr_tax)), 4);\n                    net_price -= pr_tax_val;\n                    tax = lang.inclusive;\n                } else {\n                    pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100, 4);\n                    tax = lang.exclusive;\n                }\n            }\n            product_tax += formatDecimal(pr_tax_val * item_qty, 4);\n\n            var row_no = new Date().getTime();\n            var newTr = $(\n                '<tr id=\"' + row_no + '\" class=\"' + item_id + '\" data-item-id=\"' + item_id + '\" data-id=\"' + item.row.id + '\"></tr>'\n            );\n            tr_html =\n                '<td><input name=\"product_id[]\" type=\"hidden\" class=\"rid\" value=\"' +\n                product_id +\n                '\"><input name=\"item_comment[]\" type=\"hidden\" class=\"ritem_comment\" value=\"' +\n                item_comment +\n                '\"><input name=\"product_code[]\" type=\"hidden\" value=\"' +\n                item.row.code +\n                '\"><input name=\"product_name[]\" type=\"hidden\" value=\"' +\n                item.row.name +\n                '\"><button type=\"button\" class=\"btn bg-purple btn-block btn-xs edit\" id=\"' +\n                row_no +\n                '\" data-item=\"' +\n                item_id +\n                '\"><span class=\"sname\" id=\"name_' +\n                row_no +\n                '\">' +\n                item_name +\n                ' (' +\n                item_code +\n                ')</span></button></td>';\n            // <input class=\"rprice\" name=\"net_price[]\" type=\"hidden\" id=\"price_' + row_no + '\" value=\"' + formatDecimal(item_price) + '\">\n            tr_html +=\n                '<td class=\"text-right\"><input class=\"realuprice\" name=\"real_unit_price[]\" type=\"hidden\" value=\"' +\n                item.row.real_unit_price +\n                '\"><input class=\"rdiscount\" name=\"product_discount[]\" type=\"hidden\" id=\"discount_' +\n                row_no +\n                '\" value=\"' +\n                ds +\n                '\"><span class=\"text-right sprice\" id=\"sprice_' +\n                row_no +\n                '\">' +\n                formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val)) +\n                '</span></td>';\n            tr_html +=\n                '<td><input name=\"item_was_ordered[]\" type=\"hidden\" class=\"riwo\" value=\"' +\n                item_was_ordered +\n                '\"><input class=\"form-control input-qty kb-pad text-center rquantity\" name=\"quantity[]\" type=\"text\" value=\"' +\n                formatDecimal(item_qty) +\n                '\" data-id=\"' +\n                row_no +\n                '\" data-item=\"' +\n                item_id +\n                '\" id=\"quantity_' +\n                row_no +\n                '\" onClick=\"this.select();\"></td>';\n            tr_html +=\n                '<td class=\"text-right\"><span class=\"text-right ssubtotal\" id=\"subtotal_' +\n                row_no +\n                '\">' +\n                formatMoney((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty)) +\n                '</span></td>';\n            tr_html += '<td class=\"text-center\"><i class=\"fa fa-trash-o tip pointer posdel\" id=\"' + row_no + '\" title=\"Remove\"></i></td>';\n            newTr.html(tr_html);\n            newTr.prependTo('#posTable');\n            total += formatDecimal((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty), 4);\n            count += parseFloat(item_qty);\n            an++;\n            // $('#list-table-div').scrollTop(0);\n            var oitb = $('#list-table-div')[0].scrollHeight;\n            $('#list-table-div').slimScroll({ scrollTo: oitb });\n            if (item_type == 'standard' && item_qty > item_aqty) {\n                $('#' + row_no).addClass('danger');\n                $('#' + row_no)\n                    .find('.edit')\n                    .removeClass('bg-purple')\n                    .addClass('btn-warning');\n            } else if (item_type == 'combo') {\n                if (combo_items === false) {\n                    $('#' + row_no).addClass('danger');\n                } else {\n                    $.each(combo_items, function() {\n                        if (parseFloat(this.quantity) < parseFloat(this.qty) * item_qty) {\n                            $('#' + row_no).addClass('danger');\n                            $('#' + row_no)\n                                .find('.edit')\n                                .removeClass('bg-purple')\n                                .addClass('btn-warning');\n                        }\n                    });\n                }\n            }\n\n            var comments = item_comment ? item_comment.split(/\\r?\\n/g) : [];\n            if (Settings.remote_printing != 1) {\n                b_items += '#' + (an - 1) + ' ' + item_name + ' (' + item_code + ')' + '\\n';\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    b_items += comments[i].length > 0 ? '   * ' + comments[i] + '\\n' : '';\n                }\n                b_items +=\n                    printLine(\n                        item_qty +\n                            ' x ' +\n                            formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val)) +\n                            ': ' +\n                            formatMoney((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty))\n                    ) + '\\n';\n                o_items +=\n                    printLine(\n                        '#' +\n                            (an - 1) +\n                            ' ' +\n                            item_name +\n                            ' (' +\n                            item_code +\n                            '): [ ' +\n                            (item_was_ordered != 0 ? 'xxxx' : parseFloat(item_qty))\n                    ) + ' ]\\n';\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    o_items += comments[i].length > 0 ? '   * ' + comments[i] + '\\n' : '';\n                }\n                o_items += '\\n';\n            } else {\n                var bprTr =\n                    '<tr class=\"row_' +\n                    item_id +\n                    '\" data-item-id=\"' +\n                    item_id +\n                    '\"><td colspan=\"2\">#' +\n                    (an - 1) +\n                    ' ' +\n                    (item_id == 0 ? item.row.name : item_name + ' (' + item_code + ')');\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    bprTr += comments[i] ? '<br> <b>*</b> <small>' + comments[i] + '</small>' : '';\n                }\n                bprTr += '</td></tr>';\n                bprTr +=\n                    '<tr class=\"bb row_' +\n                    item_id +\n                    '\" data-item-id=\"' +\n                    item_id +\n                    '\"><td>(' +\n                    item_qty +\n                    ' x ' +\n                    formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val)) +\n                    ')</td><td style=\"text-align:right;\">' +\n                    formatMoney((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty)) +\n                    '</td></tr>';\n                var oprTr =\n                    '<tr class=\"bb row_' +\n                    item_id +\n                    '\" data-item-id=\"' +\n                    item_id +\n                    '\"><td>#' +\n                    (an - 1) +\n                    ' ' +\n                    item_name +\n                    ' (' +\n                    item_code +\n                    ')';\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    oprTr += comments[i] ? '<br> <b>*</b> <small>' + comments[i] + '</small>' : '';\n                }\n                oprTr += '</td><td>[ ' + (item_was_ordered != 0 ? 'xxxx' : parseFloat(item_qty)) + ' ]</td></tr>';\n                $('#order-table').append(oprTr);\n                $('#bill-table').append(bprTr);\n            }\n        });\n\n        var ds = get('spos_discount') ? get('spos_discount') : $('#discount_val').val() ? $('#discount_val').val() : '0';\n        order_discount = parseFloat(ds);\n        if (ds.indexOf('%') !== -1) {\n            var pds = ds.split('%');\n            order_discount = parseFloat((total * parseFloat(pds[0])) / 100);\n        }\n\n        var ts = get('spos_tax') ? get('spos_tax') : $('#tax_val').val() ? $('#tax_val').val() : '0';\n        order_tax = parseFloat(ts);\n        if (ts.indexOf('%') !== -1) {\n            var pts = ts.split('%');\n            order_tax = ((total - order_discount) * parseFloat(pts[0])) / 100;\n        }\n\n        var g_total = total - parseFloat(order_discount) + parseFloat(order_tax);\n        grand_total = formatMoney(g_total);\n        $('#ds_con').text('(' + formatMoney(product_discount) + ') ' + formatMoney(order_discount));\n        $('#ts_con').text(formatMoney(order_tax));\n        $('#total-payable').text(grand_total);\n        $('#total').text(formatMoney(total));\n        $('#count').text(an - 1 + ' (' + formatMoney(count - 1) + ')');\n\n        if (Settings.remote_printing != 1) {\n            order_data.items = o_items;\n            bill_data.items = b_items;\n            var b_totals = '';\n            b_totals += printLine(lang.total + ': ' + formatMoney(total)) + '\\n';\n            if (order_discount > 0 || product_discount > 0) {\n                b_totals += printLine(lang.discount + ': ' + formatMoney(order_discount + product_discount)) + '\\n';\n            }\n            if (order_tax != 0) {\n                b_totals += printLine(lang.order_tax + ': ' + formatMoney(order_tax)) + '\\n';\n            }\n            b_totals += printLine(lang.grand_total + ': ' + formatMoney(g_total)) + '\\n';\n            if (Settings.rounding != 0) {\n                round_total = roundNumber(g_total, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - g_total, 4);\n                b_totals += printLine(lang.rounding + ': ' + formatMoney(rounding)) + '\\n';\n                b_totals += printLine(lang.total_payable + ': ' + formatMoney(round_total)) + '\\n';\n            }\n            b_totals += '\\n' + lang.total_items + ': ' + (an - 1) + ' (' + (parseFloat(count) - 1) + ')' + '\\n';\n            bill_data.totals = b_totals;\n        } else {\n            var bill_totals = '';\n            bill_totals +=\n                '<tr class=\"bb\"><td>' +\n                lang.total_items +\n                '</td><td style=\"text-align:right;\">' +\n                (an - 1) +\n                ' (' +\n                (parseFloat(count) - 1) +\n                ')</td></tr>';\n            bill_totals += '<tr class=\"bb\"><td>' + lang.total + '</td><td style=\"text-align:right;\">' + formatMoney(total) + '</td></tr>';\n            if (order_discount > 0 || product_discount > 0) {\n                bill_totals +=\n                    '<tr class=\"bb\"><td>' +\n                    lang.discount +\n                    '</td><td style=\"text-align:right;\">' +\n                    formatMoney(order_discount + product_discount) +\n                    '</td></tr>';\n            }\n            if (order_tax != 0) {\n                bill_totals +=\n                    '<tr class=\"bb\"><td>' + lang.order_tax + '</td><td style=\"text-align:right;\">' + formatMoney(order_tax) + '</td></tr>';\n            }\n            bill_totals +=\n                '<tr class=\"bb\"><td>' + lang.grand_total + '</td><td style=\"text-align:right;\">' + formatMoney(g_total) + '</td></tr>';\n            if (Settings.rounding != 0) {\n                round_total = roundNumber(g_total, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - g_total, 4);\n                bill_totals +=\n                    '<tr class=\"bb\"><td>' + lang.rounding + '</td><td style=\"text-align:right;\">' + formatMoney(rounding) + '</td></tr>';\n                bill_totals +=\n                    '<tr class=\"bb\"><td>' +\n                    lang.total_payable +\n                    '</td><td style=\"text-align:right;\">' +\n                    formatMoney(round_total) +\n                    '</td></tr>';\n            }\n            bill_totals += '<tr class=\"bb\"><td colspan=\"2\" style=\"text-align:center;\">' + lang.merchant_copy + '</td></tr>';\n            $('#bill-total-table').empty();\n            $('#bill-total-table').append(bill_totals);\n        }\n\n        if (Settings.display_kb == 1) {\n            display_keyboards();\n        }\n        $('#add_item').focus();\n    }\n}\n\nfunction chr(i) {\n    return String.fromCharCode(i);\n}\n\n$(document).ready(function() {\n    $(document).on('click', '.no-results, #filter-suspended-sales', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    $('#susModal').on('shown.bs.modal', function(e) {\n        $('#reference_note').focus();\n    });\n\n    $('#filter-categories').hideseek({\n        nodata: lang.no_match_found,\n    });\n\n    $(document).on('click', '.suspended_sales .dropdown-menu .header', function(e) {\n        e.stopPropagation();\n    });\n\n    $('#filter-suspended-sales').hideseek({\n        nodata: lang.no_match_found,\n    });\n\n    $('#suspended_sales').on('shown.bs.dropdown', function() {\n        $('#filter-suspended-sales').focus();\n    });\n\n    $(document).on('click', '#update-note', function() {\n        var n = $('#snote').val();\n        store('spos_note', n);\n        $('#note').val(n);\n        $('#noteModal').modal('hide');\n    });\n    /* =============================\n    Edit Item Modal\n    ============================= */\n\n    $('#posTable').on('click', '.edit', function() {\n        var row = $(this).closest('tr');\n        var id = row.attr('id');\n        var item_id = row.attr('data-item-id');\n        var item_rid = row.attr('data-id');\n        var item = spositems[item_id];\n        //var unit_price = parseFloat(item.row.real_unit_price);\n        var unit_price = formatDecimal(row.find('.realuprice').val());\n        var net_price = unit_price;\n        var ds = item.row.discount ? item.row.discount : '0';\n        item_discount = formatDecimal(parseFloat(ds));\n        if (ds.indexOf('%') !== -1) {\n            var pds = ds.split('%');\n            if (!isNaN(pds[0])) {\n                item_discount = formatDecimal((net_price * parseFloat(pds[0])) / 100);\n            }\n        }\n        net_price -= item_discount;\n        var pr_tax = parseFloat(item.row.tax),\n            pr_tax_val = 0,\n            tax = '';\n        if (pr_tax !== null && pr_tax != 0) {\n            if (parseFloat(item.row.tax_method) == 0) {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100 + parseFloat(pr_tax)));\n                net_price -= pr_tax_val;\n                tax = lang.inclusive;\n            } else {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                tax = lang.exclusive;\n            }\n        }\n        console.log(item_rid, item_id, id);\n        $('#proModalLabel').html('<a href=\"' + base_url + '/products/view/' + item_rid + '\" data-toggle=\"ajax\">' + item.label + '</a>');\n        $('#net_price').text(formatMoney(net_price));\n        $('#pro_tax').text(formatMoney(pr_tax_val));\n        $('#pro_tax_method').text('(' + tax + ')');\n        $('#row_id').val(row_id);\n        $('#item_id').val(item_id);\n        $('#nPrice').val(unit_price);\n        $('#nQuantity').val(item.row.qty);\n        $('#nDiscount').val(ds);\n        $('#nComment').val(item.row.comment);\n        $('#proModal').modal({ backdrop: 'static' });\n    });\n\n    $(document).on('change', '#nPrice, #nDiscount', function() {\n        var item_id = $('#item_id').val();\n        var unit_price = parseFloat($('#nPrice').val());\n        var net_price = unit_price;\n        var item = spositems[item_id];\n        var ds = $('#nDiscount').val() ? $('#nDiscount').val() : '0';\n        item_discount = formatDecimal(parseFloat(ds));\n        if (ds.indexOf('%') !== -1) {\n            var pds = ds.split('%');\n            if (!isNaN(pds[0])) {\n                item_discount = formatDecimal((unit_price * parseFloat(pds[0])) / 100);\n            }\n        }\n        net_price -= item_discount;\n        var pr_tax = parseFloat(item.row.tax),\n            pr_tax_val = 0;\n        if (pr_tax !== null && pr_tax != 0) {\n            if (parseFloat(item.row.tax_method) == 0) {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100 + parseFloat(pr_tax)));\n                net_price -= pr_tax_val;\n                tax = lang.inclusive;\n            } else {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                tax = lang.exclusive;\n            }\n        }\n\n        $('#net_price').text(formatMoney(net_price));\n        $('#pro_tax').text(formatMoney(pr_tax_val));\n    });\n\n    /* =============================\n    Edit Item Method\n    ============================= */\n    $(document).on('click', '#editItem', function() {\n        var item_id = $('#item_id').val();\n        var price = parseFloat($('#nPrice').val());\n        if (!is_valid_discount($('#nDiscount').val())) {\n            bootbox.alert(lang.unexpected_value);\n            return false;\n        }\n        (spositems[item_id].row.qty = parseFloat($('#nQuantity').val())),\n            (spositems[item_id].row.real_unit_price = price),\n            (spositems[item_id].row.comment = $('#nComment').val()),\n            (spositems[item_id].row.discount = $('#nDiscount').val() ? $('#nDiscount').val() : '0'),\n            localStorage.setItem('spositems', JSON.stringify(spositems));\n        $('#proModal').modal('hide');\n\n        loadItems();\n        return;\n    });\n\n    /* =============================\n    Row quantity change\n    ============================= */\n    $(document).on('change', '.rquantity', function() {\n        var row = $(this).closest('tr');\n        if (!is_numeric($(this).val()) || $(this).val() == 0) {\n            loadItems();\n            bootbox.alert(lang.unexpected_value);\n            return false;\n        }\n        var new_qty = parseFloat($(this).val()),\n            item_id = row.attr('data-item-id');\n        spositems[item_id].row.qty = new_qty;\n        localStorage.setItem('spositems', JSON.stringify(spositems));\n        loadItems();\n    });\n\n    $('#reset').click(function(e) {\n        if (count <= 1) {\n            return false;\n        }\n        if (protect_delete == 1) {\n            var boxd = bootbox.dialog({\n                title: lang.enter_pin_code,\n                closeButton: true,\n                message: '<input id=\"pos_pin\" name=\"pos_pin\" type=\"password\" placeholder=\"Pin Code\" class=\"form-control kb-pad\"> ',\n                buttons: {\n                    danger: {\n                        label: lang.close,\n                        className: 'btn-default pull-left',\n                        callback: function() {},\n                    },\n                    success: {\n                        label: \"<i class='fa fa-tick'></i> \" + lang.delete,\n                        className: 'btn-warning verify_pin',\n                        callback: function() {\n                            var pos_pin = md5($('#pos_pin').val());\n                            if (pos_pin == Settings.pin_code) {\n                                if (get('spositems')) {\n                                    remove('spositems');\n                                }\n                                if (get('spos_tax')) {\n                                    remove('spos_tax');\n                                }\n                                if (get('spos_discount')) {\n                                    remove('spos_discount');\n                                }\n                                if (get('spos_customer')) {\n                                    remove('spos_customer');\n                                }\n                                window.location.href = base_url + 'pos';\n                            } else {\n                                bootbox.alert(lang.wrong_pin);\n                            }\n                        },\n                    },\n                },\n            });\n            boxd.on('shown.bs.modal', function() {\n                if (Settings.display_kb == 1) {\n                    display_keyboards();\n                }\n                $('#pos_pin')\n                    .focus()\n                    .keypress(function(e) {\n                        if (e.keyCode == 13) {\n                            e.preventDefault();\n                            $('.verify_pin').trigger('click');\n                            return false;\n                        }\n                    });\n            });\n        } else {\n            bootbox.confirm(lang.r_u_sure, function(result) {\n                if (result) {\n                    if (get('spositems')) {\n                        remove('spositems');\n                    }\n                    if (get('spos_tax')) {\n                        remove('spos_tax');\n                    }\n                    if (get('spos_discount')) {\n                        remove('spos_discount');\n                    }\n                    if (get('spos_customer')) {\n                        remove('spos_customer');\n                    }\n                    window.location.href = base_url + 'pos';\n                }\n            });\n        }\n    });\n\n    $('#print_order').click(function(e) {\n        e.preventDefault();\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n        } else {\n            if (Settings.remote_printing == 0) {\n                $('#order-data').show();\n                if (Settings.print_img == 1) {\n                    $('#preo').html(\n                        '<pre style=\"background:#FFF;font-size:20px;margin:0;border:0;color:#000 !important;\">' +\n                            order_data.info +\n                            order_data.items +\n                            '</pre>'\n                    );\n                    var element = $('#order-data').get(0);\n                    html2canvas(element, { scrollY: 0, scale: 1.7 }).then(function(canvas) {\n                        var img = canvas.toDataURL().split(',')[1];\n                        $.post(base_url + 'pos/receipt_img', { img: img, spos_token: csrf_hash });\n                        // return Canvas2Image.saveAsPNG(canvas);\n                    });\n                } else {\n                    var form = $('#pos-sale-form').serialize();\n                    $.post(base_url + 'pos/p/order', form);\n                }\n            } else {\n                printOrder(order_data);\n            }\n        }\n        setTimeout(function() {\n            $('#order-data').hide();\n        }, 500);\n        return false;\n    });\n\n    $('#print_bill').click(function(e) {\n        e.preventDefault();\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n        } else {\n            if (Settings.remote_printing == 0) {\n                $('#bill-data').show();\n                if (Settings.print_img == 1) {\n                    $('#preb').html(\n                        '<pre style=\"background:#FFF;font-size:20px;margin:0;border:0;color:#000 !important;\">' +\n                            bill_data.info +\n                            bill_data.items +\n                            '\\n' +\n                            bill_data.totals +\n                            '</pre>'\n                    );\n                    var element = $('#bill-data').get(0);\n                    html2canvas(element, { scrollY: 0, scale: 1.7 }).then(function(canvas) {\n                        var img = canvas.toDataURL().split(',')[1];\n                        $.post(base_url + 'pos/receipt_img', { img: img, spos_token: csrf_hash });\n                        // return Canvas2Image.saveAsPNG(canvas);\n                    });\n                } else {\n                    var form = $('#pos-sale-form').serialize();\n                    $.post(base_url + 'pos/p/bill', form);\n                }\n            } else {\n                printBill(bill_data);\n            }\n        }\n        setTimeout(function() {\n            $('#bill-data').hide();\n        }, 500);\n        return false;\n    });\n\n    $('#updateDiscount').click(function() {\n        var ds = $('#get_ds').val() ? $('#get_ds').val() : '0';\n        var apply_to = $('input[name=apply_to]:checked').val();\n        if (ds.length != 0) {\n            if (apply_to == 'order') {\n                $('#discount_val').val(ds);\n                store('spos_discount', ds);\n                if (ds.indexOf('%') !== -1) {\n                    var pds = ds.split('%');\n\n                    order_discount = (total * parseFloat(pds[0])) / 100;\n                    order_tax = calTax();\n                    var g_total = total + order_tax - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ds_con').text('(' + formatMoney(product_discount) + ') ' + formatMoney(order_discount));\n                    $('#total-payable').text(formatMoney(grand_total));\n                } else {\n                    order_discount = ds;\n                    order_tax = calTax();\n                    var g_total = total + order_tax - parseFloat(order_discount);\n                    grand_total = parseFloat(g_total);\n                    $('#ds_con').text('(' + formatMoney(product_discount) + ') ' + formatMoney(order_discount));\n                    $('#total-payable').text(formatMoney(grand_total));\n                }\n            } else if (apply_to == 'products') {\n                var items = {};\n                spositems = JSON.parse(get('spositems'));\n                $.each(spositems, function() {\n                    this.row.discount = ds;\n                });\n                store('spositems', JSON.stringify(spositems));\n            }\n            loadItems();\n            $('#dsModal').modal('hide');\n        }\n    });\n\n    $('#add_discount').click(function() {\n        var dval = $('#discount_val').val();\n        $('#get_ds').val(dval);\n        $('#dsModal').modal({ backdrop: 'static' });\n        return false;\n    });\n    $('#dsModal').on('shown.bs.modal', function() {\n        $('#get_ds').focusToEnd();\n    });\n\n    $('#updateTax').click(function() {\n        var ts = $('#get_ts').val();\n        if (ts.length != 0) {\n            $('#tax_val').val(ts);\n            store('spos_tax', ts);\n            if (ts.indexOf('%') !== -1) {\n                var pts = ts.split('%');\n                if (!isNaN(pts[0])) {\n                    order_tax = ((total - order_discount) * parseFloat(pts[0])) / 100;\n                    var g_total = total + order_tax - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ts_con').text(formatMoney(order_tax));\n                    $('#total-payable').text(formatMoney(grand_total));\n                } else {\n                    $('#get_ts').val('0');\n                    $('#tax_val').val('0');\n                    var g_total = total - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ts_con').text('0');\n                    $('#total-payable').text(formatMoney(grand_total));\n                }\n            } else {\n                if (!isNaN(ts) && ts != 0) {\n                    order_tax = ts;\n                    var g_total = total + parseFloat(ts) - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ts_con').text(formatMoney(order_tax));\n                    $('#total-payable').text(formatMoney(grand_total));\n                } else {\n                    $('#get_ts').val('0');\n                    $('#tax_val').val('0');\n                    var g_total = total - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ts_con').text('0');\n                    $('#total-payable').text(formatMoney(grand_total));\n                }\n            }\n            $('#tsModal').modal('hide');\n        }\n    });\n\n    $('#add_tax').click(function() {\n        var tval = $('#tax_val').val();\n        $('#get_ts').val(tval);\n        $('#tsModal').modal({ backdrop: 'static' });\n        return false;\n    });\n    $('#tsModal').on('shown.bs.modal', function() {\n        $('#get_ts').focusToEnd();\n    });\n    $('#noteModal').on('shown.bs.modal', function() {\n        $('#snote').focusToEnd();\n    });\n\n    $(document).on('click', '.product', function(e) {\n        code = $(this).val();\n        $.ajax({\n            type: 'get',\n            url: base_url + 'pos/get_product/' + code,\n            dataType: 'json',\n            success: function(data) {\n                if (data !== null) {\n                    add_invoice_item(data);\n                } else {\n                    bootbox.alert(lang.no_match_found);\n                }\n            },\n        });\n    });\n\n    $(document).on('click', '.category', function() {\n        var cid = $(this).attr('id');\n        if (cat_id != cid) {\n            cat_id = cid;\n            $.ajax({\n                type: 'get',\n                url: base_url + 'pos/ajaxproducts',\n                data: { category_id: cat_id, tcp: 1 },\n                dataType: 'json',\n                success: function(data) {\n                    p_page = 'n';\n                    // $('#categories-list').addClass('control-sidebar-open');\n                    //ocat_id = cat_id;\n                    tcp = data.tcp;\n                    $('.items').html(data.products);\n                    $('.category').removeClass('active');\n                    $('#' + cat_id).addClass('active');\n                    nav_pointer();\n                },\n            });\n        }\n        return false;\n    });\n    $('#category-' + cat_id).addClass('active');\n\n    $('#next').click(function() {\n        if (p_page == 'n') {\n            p_page = 0;\n        }\n        p_page += pro_limit;\n        if (tcp >= pro_limit && p_page < tcp) {\n            $.ajax({\n                type: 'get',\n                url: base_url + 'pos/ajaxproducts',\n                data: { category_id: cat_id, per_page: p_page },\n                dataType: 'html',\n                success: function(data) {\n                    $('.items').html(data);\n                    nav_pointer();\n                },\n            });\n        } else {\n            p_page -= pro_limit;\n        }\n    });\n\n    $('#previous').click(function() {\n        if (p_page == 'n') {\n            p_page = 0;\n        }\n        if (p_page != 0) {\n            p_page -= pro_limit;\n            if (p_page == 0) {\n                p_page = 'n';\n            }\n            $.ajax({\n                type: 'get',\n                url: base_url + 'pos/ajaxproducts',\n                data: { category_id: cat_id, per_page: p_page },\n                dataType: 'html',\n                success: function(data) {\n                    $('.items').html(data);\n                    nav_pointer();\n                },\n            });\n        }\n    });\n\n    $('#add_item').autocomplete({\n        source: base_url + 'pos/suggestions',\n        minLength: 1,\n        autoFocus: false,\n        delay: 200,\n        response: function(event, ui) {\n            if ($(this).val().length >= 16 && ui.content[0].id == 0) {\n                bootbox.alert(lang.no_match_found, function() {\n                    $('#add_item').focus();\n                });\n                $(this).val('');\n            } else if (ui.content.length == 1 && ui.content[0].id != 0) {\n                ui.item = ui.content[0];\n                $(this)\n                    .data('ui-autocomplete')\n                    ._trigger('select', 'autocompleteselect', ui);\n                $(this).autocomplete('close');\n            } else if (ui.content.length == 1 && ui.content[0].id == 0) {\n                bootbox.alert(lang.no_match_found, function() {\n                    $('#add_item').focus();\n                });\n                $(this).val('');\n            }\n        },\n        select: function(event, ui) {\n            event.preventDefault();\n            if (ui.item.id !== 0) {\n                var row = add_invoice_item(ui.item);\n                if (row) $(this).val('');\n            } else {\n                bootbox.alert(lang.no_match_found);\n            }\n        },\n    });\n\n    $('#add_item').bind('keypress', function(e) {\n        if (e.keyCode == 13) {\n            e.preventDefault();\n            $(this).autocomplete('search');\n        }\n    });\n\n    $('#add_item').focus();\n    $('#gccard_no').inputmask('9999 9999 9999 9999');\n    $('#gift_card_no').inputmask('9999 9999 9999 9999');\n    $('#gcexpiry').inputmask('yyyy-mm-dd', { placeholder: 'yyyy-mm-dd' });\n    $('#genNo').click(function() {\n        var no = generateCardNo();\n        $(this)\n            .parent()\n            .parent('.input-group')\n            .children('input')\n            .val(no);\n        return false;\n    });\n\n    $(document).on('click', '#sellGiftCard', function(e) {\n        if (count == 1) {\n            spositems = {};\n        }\n        $('#gcModal').modal({ backdrop: 'static' });\n    });\n\n    $(document).on('click', '#addGiftCard', function(e) {\n        var mid = 0,\n            gccode = $('#gccard_no').val(),\n            gcname = $('#gcname').val(),\n            gcvalue = $('#gcvalue').val(),\n            gcprice = parseFloat($('#gcprice').val());\n        gcexpiry = $('#gcexpiry').val();\n        if (gccode == '' || gcvalue == '' || gcprice == '' || gcvalue == 0 || gcprice == 0) {\n            $('#gcerror').text(lang.file_required_fields);\n            $('.gcerror-con').show();\n            return false;\n        }\n        var gc_data = new Array();\n        gc_data[0] = gccode;\n        gc_data[1] = gcvalue;\n        gc_data[2] = gcexpiry;\n\n        $.ajax({\n            type: 'get',\n            url: base_url + 'gift_cards/sell_gift_card',\n            dataType: 'json',\n            data: { gcdata: gc_data },\n            success: function(data) {\n                if (data.result === 'success') {\n                    spositems[mid] = {\n                        id: mid,\n                        item_id: mid,\n                        label: gcname + ' (' + gccode + ')',\n                        row: {\n                            id: mid,\n                            code: gccode,\n                            name: gcname,\n                            quantity: 1,\n                            price: gcprice,\n                            real_unit_price: gcprice,\n                            tax: 0,\n                            qty: 1,\n                            type: 'manual',\n                            discount: '0',\n                            comment: '',\n                        },\n                    };\n                    store('spositems', JSON.stringify(spositems));\n                    loadItems();\n                    $('#gcModal').modal('hide');\n                    $('#gccard_no').val('');\n                    $('#gcvalue').val('');\n                    $('#gcprice').val('');\n                } else {\n                    $('#gcerror').text(data.message);\n                    $('.gcerror-con').show();\n                }\n            },\n        });\n    });\n\n    // $('#opModal').bind().on('click', 'a', function(){\n    //     var pg = $.url($(this).attr(\"href\")).param(\"per_page\");\n    //     $.get( base_url+'pos/ob_page&per_page='+pg, function( data ) {\n    //         $( \".html_con\" ).html( data.pd );\n    //         $( \".page_con\" ).html( data.page );\n    //     }, \"json\");\n\n    //     return false;\n    // });\n\n    var pwacc = false;\n    $(document).on('click', '.posdel', function() {\n        var row = $(this).closest('tr');\n        var item_id = row.attr('data-item-id');\n        if (protect_delete == 1) {\n            var boxd = bootbox.dialog({\n                title: lang.enter_pin_code,\n                closeButton: true,\n                message: '<input id=\"pos_pin\" name=\"pos_pin\" type=\"password\" placeholder=\"Pin Code\" class=\"form-control kb-pad\"> ',\n                buttons: {\n                    danger: {\n                        label: lang.close,\n                        className: 'btn-default pull-left',\n                        callback: function() {},\n                    },\n                    success: {\n                        label: \"<i class='fa fa-tick'></i> \" + lang.delete,\n                        className: 'btn-warning verify_pin',\n                        callback: function() {\n                            var pos_pin = md5($('#pos_pin').val());\n                            if (pos_pin == Settings.pin_code) {\n                                delete spositems[item_id];\n                                row.remove();\n                                if (spositems.hasOwnProperty(item_id)) {\n                                } else {\n                                    localStorage.setItem('spositems', JSON.stringify(spositems));\n                                    loadItems();\n                                }\n                            } else {\n                                bootbox.alert(lang.wrong_pin);\n                            }\n                        },\n                    },\n                },\n            });\n            boxd.on('shown.bs.modal', function() {\n                if (Settings.display_kb == 1) {\n                    display_keyboards();\n                }\n                $('#pos_pin')\n                    .focus()\n                    .keypress(function(e) {\n                        if (e.keyCode == 13) {\n                            e.preventDefault();\n                            $('.verify_pin').trigger('click');\n                            return false;\n                        }\n                    });\n            });\n        } else {\n            delete spositems[item_id];\n            row.remove();\n            if (spositems.hasOwnProperty(item_id)) {\n            } else {\n                localStorage.setItem('spositems', JSON.stringify(spositems));\n                loadItems();\n            }\n        }\n        return false;\n    });\n\n    $('#suspend').click(function() {\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n            return false;\n        } else {\n            $('#susModal').modal({ backdrop: 'static' });\n        }\n    });\n\n    $('#suspend_sale').click(function() {\n        ref = $('#reference_note').val();\n        if (!ref || ref == '') {\n            bootbox.alert(lang.type_reference_note);\n            return false;\n        } else {\n            suspend = $('<span></span>');\n            if (sid !== 0) {\n                suspend.html(\n                    '<input type=\"hidden\" name=\"delete_id\" value=\"' +\n                        sid +\n                        '\" /><input type=\"hidden\" name=\"suspend\" value=\"yes\" /><input type=\"hidden\" name=\"suspend_note\" value=\"' +\n                        ref +\n                        '\" />'\n                );\n            } else {\n                suspend.html(\n                    '<input type=\"hidden\" name=\"suspend\" value=\"yes\" /><input type=\"hidden\" name=\"suspend_note\" value=\"' + ref + '\" />'\n                );\n            }\n            suspend.appendTo('#hidesuspend');\n            $('#pos-sale-form').submit();\n        }\n    });\n\n    $('#payment').click(function() {\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n            return false;\n        } else {\n            if (sid) {\n                suspend = $('<span></span>');\n                suspend.html('<input type=\"hidden\" name=\"delete_id\" value=\"' + sid + '\" />');\n                suspend.appendTo('#hidesuspend');\n            }\n\n            gtotal = formatDecimal(total - order_discount + order_tax);\n            if (Settings.rounding != 0) {\n                round_total = roundNumber(gtotal, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - gtotal);\n                $('#twt').text(formatMoney(round_total) + ' (' + formatMoney(rounding) + ')');\n                $('#quick-payable').text(round_total);\n            } else {\n                $('#twt').text(formatMoney(gtotal));\n                $('#quick-payable').text(gtotal);\n            }\n            $('#item_count').text(an - 1 + ' (' + (count - 1) + ')');\n            $('#order_quantity').val(count - 1);\n            $('#order_items').val(an - 1);\n            $('#balance').text('0.00');\n            $('#payModal').modal({ backdrop: 'static' });\n        }\n    });\n    $('#payModal').on('shown.bs.modal', function(e) {\n        $('#amount')\n            .focus()\n            .val(0);\n        $('#quick-payable').click();\n    });\n    $('#payModal').on('hidden.bs.modal', function(e) {\n        $('#amount')\n            .val('')\n            .change();\n    });\n\n    $('#amount').change(function(e) {\n        var total_paying = $('.amount').val();\n        $('#total_paying').text(formatMoney(total_paying));\n        if (Settings.rounding != 0) {\n            $('#balance').text(formatMoney(total_paying - round_total));\n            $('#balance_val').val(formatDecimal(total_paying - round_total));\n            total_paid = total_paying;\n            grand_total = round_total;\n        } else {\n            $('#balance').text(formatMoney(total_paying - gtotal));\n            $('#balance_val').val(formatDecimal(total_paying - gtotal));\n            total_paid = total_paying;\n            grand_total = gtotal;\n        }\n    });\n\n    $('#add-customer').click(function() {\n        $('#customerModal').modal({ backdrop: 'static' });\n    });\n\n    $('#payModal').on('change', '#paid_by', function() {\n        $('#clear-cash-notes').click();\n        $('#amount').val(grand_total);\n        var p_val = $(this).val();\n        $('#paid_by_val').val(p_val);\n        var gtotal = formatDecimal(total - order_discount + order_tax);\n        if (Settings.rounding != 0) {\n            var rounded_total = formatDecimal(roundNumber(gtotal, parseInt(Settings.rounding)));\n        } else {\n            var rounded_total = formatDecimal(gtotal);\n        }\n        $('#rpaidby').val(p_val);\n        if (p_val == 'gift_card') {\n            $('.gc').slideDown();\n            $('.ngc').slideUp('fast');\n            setTimeout(function() {\n                $('#gift_card_no').focus();\n            }, 10);\n            $('#amount').attr('readonly', true);\n        } else {\n            $('.ngc').slideDown();\n            $('.gc').slideUp('fast');\n            $('#gc_details').html('');\n            $('#amount').attr('readonly', false);\n        }\n        if (p_val == 'cash' || p_val == 'other') {\n            $('.pcash').slideDown();\n            $('.pcheque').slideUp('fast');\n            $('.pcc').slideUp('fast');\n            setTimeout(function() {\n                $('#amount').focus();\n            }, 10);\n        } else if (p_val == 'CC' || p_val == 'stripe') {\n            $('.pcc').slideDown();\n            $('.pcheque').slideUp('fast');\n            $('.pcash').slideUp('fast');\n            $('#amount').val(rounded_total);\n            setTimeout(function() {\n                $('#swipe')\n                    .val('')\n                    .focus();\n            }, 10);\n        } else if (p_val == 'cheque') {\n            $('.pcheque').slideDown();\n            $('.pcc').slideUp('fast');\n            $('.pcash').slideUp('fast');\n            $('#amount').val(rounded_total);\n            setTimeout(function() {\n                $('#cheque_no').focus();\n            }, 10);\n        } else {\n            $('.pcheque').hide();\n            $('.pcc').hide();\n            $('.pcash').hide();\n        }\n    });\n\n    $(document).on('change', '.gift_card_no', function() {\n        var cn = $(this).val() ? $(this).val() : '';\n        if (cn != '') {\n            $.ajax({\n                type: 'get',\n                async: false,\n                url: base_url + 'pos/validate_gift_card/' + cn,\n                dataType: 'json',\n                success: function(data) {\n                    if (data === false || data.balance < 0) {\n                        $('#gift_card_no')\n                            .parent('.form-group')\n                            .addClass('has-error');\n                        bootbox.alert(lang.incorrect_gift_card);\n                    } else {\n                        $('#gc_details').html(\n                            lang.card_no +\n                                ': ' +\n                                data.card_no +\n                                '<br>' +\n                                lang.value +\n                                ': ' +\n                                data.value +\n                                ' - ' +\n                                lang.balance +\n                                ': ' +\n                                data.balance\n                        );\n                        $('#gift_card_no')\n                            .parent('.form-group')\n                            .removeClass('has-error');\n                        var paying = gtotal > data.balance ? data.balance : gtotal;\n                        $('#amount_val').val(paying);\n                        $('#amount').val(paying);\n                    }\n                },\n            });\n        }\n        return false;\n    });\n\n    $(document).on('click', '#quick-payable', function() {\n        $('#clear-cash-notes').click();\n        $(this).append('<span class=\"badge\">1</span>');\n        $('#amount').val(grand_total);\n    });\n\n    $(document).on('click', '.quick-cash', function() {\n        if ($('#quick-payable').find('span.badge').length) {\n            $('#clear-cash-notes').click();\n        }\n        var $quick_cash = $(this);\n        var amt = $quick_cash\n            .contents()\n            .filter(function() {\n                return this.nodeType == 3;\n            })\n            .text();\n        var th = Settings.thousands_sep == 0 ? '' : Settings.thousands_sep;\n        var $pi = $('#amount');\n        amt = formatDecimal(amt.split(th).join('')) * 1 + $pi.val() * 1;\n        $pi.val(formatDecimal(amt))\n            .change()\n            .focus();\n        var note_count = $quick_cash.find('span');\n        if (note_count.length == 0) {\n            $quick_cash.append('<span class=\"badge\">1</span>');\n        } else {\n            note_count.text(parseInt(note_count.text()) + 1);\n        }\n    });\n\n    $(document).on('click', '#clear-cash-notes', function() {\n        $('.quick-cash')\n            .find('.badge')\n            .remove();\n        $('#amount')\n            .val('')\n            .change()\n            .focus();\n    });\n\n    $('#payModal').on('change', '#amount, #paid_by', function(e) {\n        $('#amount_val').val($('#amount').val());\n    });\n    $('#payModal').on('blur', '#amount', function(e) {\n        $('#amount_val').val($('#amount').val());\n    });\n    $('#payModal').on('select2-close', '#paid_by', function(e) {\n        $('#paid_by_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_no', function(e) {\n        $('#cc_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_holder', function(e) {\n        $('#cc_holder_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#gift_card_no', function(e) {\n        $('#paying_gift_card_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_month', function(e) {\n        $('#cc_month_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_year', function(e) {\n        $('#cc_year_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_type', function(e) {\n        $('#cc_type_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_cvv2', function(e) {\n        $('#cc_cvv2_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#cheque_no', function(e) {\n        $('#cheque_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#payment_note', function(e) {\n        $('#payment_note_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#note', function(e) {\n        var n = $(this).val();\n        store('spos_note', n);\n        $('#spos_note').val(n);\n    });\n    if ((spos_note = get('spos_note'))) {\n        $('#note').val(spos_note);\n        $('#snote').val(spos_note);\n    }\n    $('#spos_customer').change(function(e) {\n        store('spos_customer', $(this).val());\n    });\n    if ((spos_customer = get('spos_customer'))) {\n        $('#spos_customer').select2('val', spos_customer);\n    }\n\n    $('.treeview').hover(function(e) {\n        var wh = $(document).height();\n        var top = $(this).offset().top;\n        var menu = $(this).find('.treeview-menu');\n        var menuh = menu.height() + 44;\n        if (wh - top < menuh) {\n            $(this)\n                .find('a')\n                .children('span')\n                .addClass('popup');\n            menu.addClass('popup');\n        } else {\n            $(this)\n                .find('a')\n                .children('span')\n                .removeClass('popup');\n            menu.removeClass('popup');\n        }\n    });\n\n    $('body').click(function(e) {\n        if (\n            !$(e.target).hasClass('sidebar-icon') &&\n            !$(e.target).hasClass('sb') &&\n            $('#categories-list').hasClass('control-sidebar-open')\n        ) {\n            $('#categories-list').removeClass('control-sidebar-open');\n        }\n    });\n\n    $('#submit-sale').click(function() {\n        $('#total_items').val(an - 1);\n        $('#total_quantity').val(count - 1);\n        // console.log($('#amount_val').val());\n        $('#submit').click();\n    });\n\n    var hold_ref = $('#hold_ref').val();\n    $('#hold_ref').change(function() {\n        hold_ref = $(this).val();\n        $('#reference_note').val(hold_ref);\n    });\n    $('#reference_note').change(function() {\n        hold_ref = $(this).val();\n        $('#hold_ref').val(hold_ref);\n    });\n\n    $('#suspend_sale').click(function() {\n        if ($('#reference_note').val()) {\n            $('#hold_ref').val($('#reference_note').val());\n            $('#total_items').val(an - 1);\n            $('#total_quantity').val(count - 1);\n            $('#submit').click();\n        }\n        return false;\n    });\n\n    $('#customer-form').on('submit', function(e) {\n        e.preventDefault();\n        $.ajax({\n            type: 'post',\n            url: base_url + 'customers/add',\n            data: $(this).serialize(),\n            dataType: 'json',\n            success: function(res) {\n                if (res.status == 'success') {\n                    $('#spos_customer').append(\n                        $('<option></option>')\n                            .attr('value', res.id)\n                            .text(res.val)\n                    );\n                    $('#spos_customer').select2('val', res.id);\n                    $('#customerModal').modal('hide');\n                } else {\n                    $('#c-alert').html(res.msg);\n                    $('#c-alert').show();\n                }\n            },\n            error: function() {\n                bootbox.alert(lang.customer_request_failed);\n                return false;\n            },\n        });\n        return false;\n    });\n\n    $('#customerModal').on('hidden.bs.modal', function(e) {\n        $('#c-alert').hide();\n        $('#cname').val('');\n        $('#cemail').val('');\n        $('#cphone').val('');\n        $('#cf1').val('');\n        $('#cf2').val('');\n    });\n});\n\nfunction display_keyboards() {\n    if (!jQuery.browser.mobile) {\n        $('.kb-text').keyboard({\n            autoAccept: true,\n            alwaysOpen: false,\n            openOn: 'focus',\n            usePreview: false,\n            // layout: 'qwerty',\n            layout: 'custom',\n            display: {\n                bksp: '\\u2190',\n                accept: 'return',\n                default: 'ABC',\n                meta1: '123',\n                meta2: '#+=',\n            },\n            customLayout: {\n                default: [\n                    'q w e r t y u i o p {bksp}',\n                    'a s d f g h j k l {enter}',\n                    '{s} z x c v b n m , . {s}',\n                    '{meta1} {space} {cancel} {accept}',\n                ],\n                shift: [\n                    'Q W E R T Y U I O P {bksp}',\n                    'A S D F G H J K L {enter}',\n                    '{s} Z X C V B N M / ? {s}',\n                    '{meta1} {space} {meta1} {accept}',\n                ],\n                meta1: [\n                    '1 2 3 4 5 6 7 8 9 0 {bksp}',\n                    '- / : ; ( ) \\u20ac & @ {enter}',\n                    '{meta2} . , ? ! \\' \" {meta2}',\n                    '{default} {space} {default} {accept}',\n                ],\n                meta2: [\n                    '[ ] { } # % ^ * + = {bksp}',\n                    '_ \\\\ | &lt; &gt; $ \\u00a3 \\u00a5 {enter}',\n                    '{meta1} ~ . , ? ! \\' \" {meta1}',\n                    '{default} {space} {default} {accept}',\n                ],\n            },\n        });\n\n        $('.kb-pad').keyboard({\n            restrictInput: true,\n            preventPaste: true,\n            autoAccept: true,\n            alwaysOpen: false,\n            openOn: 'click',\n            usePreview: false,\n            layout: 'costom',\n            display: {\n                b: '\\u2190:Backspace',\n            },\n            customLayout: {\n                default: ['1 2 3 {b}', '4 5 6 . {clear}', '7 8 9 0 %', '{accept} {cancel}'],\n            },\n        });\n    }\n}\n\nfunction calTax() {\n    var ts = get('spos_tax') ? get('spos_tax') : $('#tax_val').val();\n    if (ts.indexOf('%') !== -1) {\n        var pts = ts.split('%');\n        order_tax = ((total - order_discount) * parseFloat(pts[0])) / 100;\n        $('#ts_con').text(formatMoney(order_tax));\n    } else {\n        order_tax = parseFloat(ts);\n        $('#ts_con').text(formatMoney(order_tax));\n    }\n    return order_tax;\n}\n\nfunction nav_pointer() {\n    var pp = p_page == 'n' ? 0 : p_page;\n    pp == 0 ? $('#previous').attr('disabled', true) : $('#previous').attr('disabled', false);\n    pp + pro_limit > tcp ? $('#next').attr('disabled', true) : $('#next').attr('disabled', false);\n}\n\nfunction Popup(data) {\n    createWin(data).then(function(w) {\n        w.close();\n    });\n}\nfunction createWin(data) {\n    return new Promise(function(resolve) {\n        var d =\n            '<!DOCTYPE html><html><head><title>Print</title><link rel=\"stylesheet\" href=\"' +\n            assets +\n            'bootstrap/css/bootstrap.min.css\" type=\"text/css\" /></head><body>' +\n            data +\n            '<script type=\"text/javascript\">window.print();</script></body></html>';\n        var mywindow = window.open(d, 'spos_print', 'height=500,width=300');\n        mywindow.document.write(d);\n        setTimeout(function() {\n            resolve(mywindow);\n        }, 20);\n    });\n}\n\n$(document).ready(function($) {\n    window.setTimeout(function() {\n        $('.alerts').slideUp();\n    }, 15000);\n    $('.alerts').on('click', function(e) {\n        $(this).slideUp();\n    });\n    $('#list-table-div').slimScroll({ start: 'bottom' });\n    $('#category-sidebar-menu').slimScroll({ width: '100%' });\n    $('.items').slimScroll({});\n});\n\nfunction posScreen() {\n    var wh = $(window).height(),\n        total_dh = $('#totaldiv').height(),\n        buttons_dh = $('.botbuttons').height(),\n        left_top_dh = $('#lefttop').outerHeight();\n    var items_dh = wh - 120,\n        list_table_dh = wh - 185 - left_top_dh - total_dh - buttons_dh;\n    $('#right-col').height(wh - 100);\n    $('.items').height(items_dh > 400 ? items_dh : 400);\n    $('#list-table-div').height(list_table_dh);\n}\n\nfunction printLine(str) {\n    var size = parseInt(Settings.char_per_line) - 4;\n    var len = str.length;\n    var res = str.split(':');\n    var newd = res[0];\n    for (i = 1; i < size - len; i++) {\n        newd += ' ';\n    }\n    newd += res[1];\n    return newd;\n}\n\n$(window).bind('resize', posScreen);\n\nfunction read_card() {}\n\n$.extend($.keyboard.keyaction, {\n    enter: function(base) {\n        if (base.$el.is('textarea')) {\n            base.insertText('\\r\\n');\n        } else {\n            base.accept();\n        }\n    },\n});\n\n$(document).ready(function() {\n    posScreen();\n    if (Settings.display_kb == 1) {\n        display_keyboards();\n    }\n    nav_pointer();\n    loadItems();\n    read_card();\n\n    $('.swipe')\n        .keypress(function(e) {\n            var TrackData = $(this).val() ? $(this).val() : '';\n            if (TrackData != '') {\n                if (e.keyCode == 13) {\n                    e.preventDefault();\n                    var p = new SwipeParserObj(TrackData);\n\n                    if (p.hasTrack1) {\n                        var CardType = null;\n                        var ccn1 = p.account.charAt(0);\n                        if (ccn1 == 4) CardType = 'Visa';\n                        else if (ccn1 == 5) CardType = 'MasterCard';\n                        else if (ccn1 == 3) CardType = 'Amex';\n                        else if (ccn1 == 6) CardType = 'Discover';\n                        else CardType = 'Visa';\n\n                        $('#pcc_no')\n                            .val(p.account)\n                            .change();\n                        $('#pcc_holder')\n                            .val(p.account_name)\n                            .change();\n                        $('#pcc_month')\n                            .val(p.exp_month)\n                            .change();\n                        $('#pcc_year')\n                            .val(p.exp_year)\n                            .change();\n                        $('#pcc_cvv2').val('');\n                        $('#pcc_type').select2('val', CardType);\n                    } else {\n                        $('#pcc_no')\n                            .val('')\n                            .change();\n                        $('#pcc_holder')\n                            .val('')\n                            .change();\n                        $('#pcc_month')\n                            .val('')\n                            .change();\n                        $('#pcc_year')\n                            .val('')\n                            .change();\n                        $('#pcc_cvv2')\n                            .val('')\n                            .change();\n                        $('#pcc_type')\n                            .val('')\n                            .change();\n                    }\n\n                    $('#pcc_cvv2').focus();\n                }\n            }\n        })\n        .blur(function(e) {\n            $(this).val('');\n        })\n        .focus(function(e) {\n            $(this).val('');\n        });\n\n    $(document).on('blur', '#pcc_no', function() {\n        var cn = $(this).val();\n        var ccn1 = cn.charAt(0);\n        if (ccn1 == 4) CardType = 'Visa';\n        else if (ccn1 == 5) CardType = 'MasterCard';\n        else if (ccn1 == 3) CardType = 'Amex';\n        else if (ccn1 == 6) CardType = 'Discover';\n        else CardType = 'Visa';\n\n        $('#pcc_type').select2('val', CardType);\n    });\n\n    $('.modal').on('hidden.bs.modal', function() {\n        $(this).removeData('bs.modal');\n    });\n    $('#clearLS').click(function(event) {\n        bootbox.confirm(lang.r_u_sure, function(result) {\n            if (result == true) {\n                localStorage.clear();\n                location.reload();\n            }\n        });\n        return false;\n    });\n\n    if (Settings.focus_add_item != '') {\n        shortcut.add(\n            Settings.focus_add_item,\n            function() {\n                $('#add_item').focus();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.add_customer != '') {\n        shortcut.add(\n            Settings.add_customer,\n            function() {\n                $('#add-customer').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.toggle_category_slider != '') {\n        shortcut.add(\n            Settings.toggle_category_slider,\n            function() {\n                $('[data-toggle=\"control-sidebar\"]').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.cancel_sale != '') {\n        shortcut.add(\n            Settings.cancel_sale,\n            function() {\n                $('#reset').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.suspend_sale != '') {\n        shortcut.add(\n            Settings.suspend_sale,\n            function() {\n                $('#suspend').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.print_order != '') {\n        shortcut.add(\n            Settings.print_order,\n            function() {\n                $('#print_order').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.print_bill != '') {\n        shortcut.add(\n            Settings.print_bill,\n            function() {\n                $('#print_bill').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.finalize_sale != '') {\n        shortcut.add(\n            Settings.finalize_sale,\n            function() {\n                $('#payment').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.today_sale != '') {\n        shortcut.add(\n            Settings.today_sale,\n            function() {\n                $('#today_sale').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.open_hold_bills != '') {\n        shortcut.add(\n            Settings.open_hold_bills,\n            function() {\n                $('#opened_bills').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.close_register != '') {\n        shortcut.add(\n            Settings.close_register,\n            function() {\n                $('#close_register').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n});\n$.fn.focusToEnd = function() {\n    return this.each(function() {\n        var v = $(this).val();\n        $(this)\n            .focus()\n            .val('')\n            .val(v);\n    });\n};\n$.ajaxSetup({ cache: false, headers: { 'cache-control': 'no-cache' } });\n"]}